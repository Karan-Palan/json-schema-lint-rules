{
  "title": "Arrays and strings should declare upper size limits",
  "description": "Omitting `maxItems` for arrays or `maxLength` for strings can lead to unbounded payloads and denial-of-service risks.",
  "examples": [
    {
      "after": {
        "$schema": "https://json-schema.org/draft/2020-12/schema",
        "type": "array",
        "maxItems": 100,
        "items": {
          "type": "integer"
        }
      },
      "before": {
        "$schema": "https://json-schema.org/draft/2020-12/schema",
        "type": "array",
        "items": {
          "type": "integer"
        }
      },
      "doc": true
    },
    {
      "after": {
        "type": "string",
        "pattern": "^[A-Z]+$",
        "maxLength": 255
      },
      "before": {
        "type": "string",
        "pattern": "^[A-Z]+$"
      }
    }
  ],
  "autofixable": false,
  "categories": [ "safety", "style" ],
  "comprehensiveExamples": [
    {
      "title": "Wrong: Array with no maxItems",
      "description": "Unbounded collections may allow excessively large payloads.",
      "after": {
        "type": "array",
        "maxItems": 100,
        "items": {
          "type": "integer"
        }
      },
      "before": {
        "type": "array",
        "items": {
          "type": "integer"
        }
      }
    },
    {
      "title": "Wrong: String with no maxLength",
      "description": "Consider adding a maxLength for large text fields.",
      "after": {
        "type": "string",
        "pattern": "^[A-Z]+$",
        "maxLength": 255
      },
      "before": {
        "type": "string",
        "pattern": "^[A-Z]+$"
      }
    },
    {
      "title": "Right: Bounded collections",
      "description": "Providing sensible upper bounds is recommended.",
      "after": {
        "type": "array",
        "maxItems": 100,
        "items": {
          "type": "integer"
        }
      },
      "before": {
        "type": "array",
        "maxItems": 100,
        "items": {
          "type": "integer"
        }
      }
    }
  ],
  "dialects": {
    "2019-09": [ "maxItems", "maxLength", "type" ],
    "2020-12": [ "maxItems", "maxLength", "type" ],
    "draft4": [ "maxItems", "maxLength", "type" ],
    "draft6": [ "maxItems", "maxLength", "type" ],
    "draft7": [ "maxItems", "maxLength", "type" ]
  },
  "message": "Add `maxItems` or `maxLength` to cap collection size.",
  "references": [
    "https://json-schema.org/understanding-json-schema/reference/array.html#length",
    "https://json-schema.org/understanding-json-schema/reference/string.html#length"
  ]
}
